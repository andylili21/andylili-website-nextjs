# 开发者指南

<cite>
**本文档引用的文件**
- [README.md](file://README.md)
- [package.json](file://package.json)
- [components.json](file://components.json)
- [eslint.config.mjs](file://eslint.config.mjs)
- [tailwind.config.js](file://tailwind.config.js)
- [next.config.ts](file://next.config.ts)
- [app/lib/i18n.ts](file://app/lib/i18n.ts)
- [app/lib/theme.ts](file://app/lib/theme.ts)
- [app/components/ThemeToggle.tsx](file://app/components/ThemeToggle.tsx)
- [app/components/LanguageSwicher.tsx](file://app/components/LanguageSwicher.tsx)
- [app/lib/posts.js](file://app/lib/posts.js)
- [app/page.tsx](file://app/page.tsx)
</cite>

## 目录
1. [简介](#简介)
2. [本地开发环境搭建](#本地开发环境搭建)
3. [项目目录结构解析](#项目目录结构解析)
4. [代码风格与格式化规范](#代码风格与格式化规范)
5. [components.json 配置说明](#componentsjson-配置说明)
6. [调试技巧与常见问题排查](#调试技巧与常见问题排查)
7. [代码贡献流程](#代码贡献流程)

## 简介
本指南旨在为新贡献者提供全面的入门指导，涵盖从环境搭建到代码贡献的完整流程。通过本指南，开发者可以快速理解项目结构、掌握开发规范，并顺利参与到项目开发中。

## 本地开发环境搭建

### 环境要求
- Node.js 20.x 或更高版本
- npm / yarn / pnpm / bun 任意包管理器

### 克隆仓库
```bash
git clone https://github.com/your-username/andylili-website-nextjs.git
cd andylili-website-nextjs
```

### 安装依赖
```bash
npm install
# 或使用其他包管理器
yarn install
pnpm install
bun install
```

### 启动开发服务器
```bash
npm run dev
# 或
yarn dev
pnpm dev
bun dev
```
开发服务器将在 [http://localhost:3000](http://localhost:3000) 启动。本项目启用 **Turbopack** 加速构建，支持代码修改后的自动热更新。

### 构建生产版本
```bash
npm run build
# 或
yarn build
```

### 启动生产服务器
```bash
npm start
# 或
yarn start
```

**Section sources**
- [README.md](file://README.md#L60-L100)
- [package.json](file://package.json#L5-L8)

## 项目目录结构解析

```
andylili-website-nextjs/
├── app/                          # Next.js App Router 主目录
│   ├── blog/                     # 博客模块
│   │   ├── [slug]/              # 动态文章路由
│   │   │   └── page.js          # 文章详情页
│   │   └── page.js              # 博客列表页
│   ├── projects/                # 项目展示模块
│   │   └── page.tsx             # 项目页面
│   ├── time-planning/           # 时间规划模块
│   │   └── page.tsx             # 时间管理页面
│   ├── components/              # 通用 UI 组件
│   │   ├── Header.js            # 页面头部
│   │   ├── Footer.js            # 页面底部
│   │   ├── Hero.js              # 首页 Hero 区域
│   │   ├── ThemeToggle.tsx      # 主题切换组件
│   │   ├── LanguageSwicher.tsx  # 语言切换组件
│   │   ├── BlogList.js          # 博客列表
│   │   ├── BlogPost.js          # 博客文章
│   │   ├── BlogPreview.js       # 博客预览
│   │   ├── ProjectCard.js       # 项目卡片
│   │   └── Projects.js          # 项目列表
│   ├── lib/                     # 工具函数库
│   │   ├── i18n.ts              # i18n 配置
│   │   ├── i18nOptions.ts       # i18n 选项
│   │   ├── posts.js             # 博客文章处理
│   │   └── theme.ts             # 主题管理
│   ├── globals.css              # 全局样式
│   ├── layout.tsx               # 根布局
│   └── page.tsx                 # 首页
├── components/magicui/          # Magic UI 组件
│   └── marquee.tsx              # 跑马灯组件
├── lib/                         # 共享工具库
│   └── utils.ts                 # 通用工具函数
├── public/locales/              # 国际化资源文件
│   ├── en/                      # 英文
│   │   ├── commen.json
│   │   └── home.json
│   └── zh/                      # 中文
│       ├── commen.json
│       └── home.json
├── next.config.ts               # Next.js 配置
├── tailwind.config.js           # Tailwind CSS 配置
├── tsconfig.json                # TypeScript 配置
└── package.json                 # 项目依赖
```

**Section sources**
- [README.md](file://README.md#L105-L180)

## 代码风格与格式化规范

### ESLint 配置
项目使用 ESLint 进行代码质量检查，配置文件为 `eslint.config.mjs`，继承了 `next/core-web-vitals` 和 `next/typescript` 规则集。

### 代码检查命令
```bash
npm run lint
# 或
yarn lint
```

### TypeScript 支持
项目全面采用 TypeScript，提供类型安全的开发体验。相关配置在 `tsconfig.json` 中定义。

### 样式规范
- 使用 Tailwind CSS 进行原子化样式开发
- 全局样式定义在 `app/globals.css`
- 动态类名管理使用 `clsx` 和 `class-variance-authority`
- 主题切换通过 `data-theme` 属性实现

**Section sources**
- [eslint.config.mjs](file://eslint.config.mjs#L1-L26)
- [tailwind.config.js](file://tailwind.config.js#L1-L27)
- [tsconfig.json](file://tsconfig.json)

## components.json 配置说明

`components.json` 文件用于配置项目组件库的相关设置：

```json
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": true,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.js",
    "css": "app/globals.css",
    "baseColor": "neutral",
    "cssVariables": true,
    "prefix": ""
  },
  "iconLibrary": "lucide",
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  }
}
```

该配置定义了：
- 使用 New York 风格的组件样式
- 支持 React Server Components (RSC)
- 使用 TypeScript (tsx)
- Tailwind CSS 相关配置路径
- 图标库使用 Lucide
- 路径别名映射，简化模块导入

**Section sources**
- [components.json](file://components.json#L1-L25)

## 调试技巧与常见问题排查

### 主题切换实现
主题功能由 `app/lib/theme.ts` 管理，通过 `ThemeToggle.tsx` 组件实现用户交互。核心逻辑包括：
- 读取系统偏好和本地存储的主题设置
- 通过 `localStorage` 持久化用户选择
- 动态更新 HTML 元素的 `data-theme` 属性

### 国际化配置
- 语言配置文件位于 `public/locales/` 目录
- 支持中文 (zh) 和英文 (en)
- 通过 `LanguageSwicher.tsx` 组件切换语言
- 配置文件：`app/lib/i18n.ts`

### 常见问题及解决方案
1. **热重载失效**
   - 检查 Node.js 版本是否满足要求（20.x+）
   - 清除 `.next` 缓存目录后重新启动
   - 确保文件保存时没有语法错误

2. **样式冲突**
   - 检查 Tailwind CSS 类名是否正确
   - 确认 `tailwind.config.js` 中的 content 配置包含所有相关文件路径
   - 避免在全局样式中定义与 Tailwind 冲突的样式规则

3. **图片加载问题**
   - 在 `next.config.ts` 的 images.domains 中添加外部域名
   - 确保图片 URL 格式正确

**Section sources**
- [app/lib/theme.ts](file://app/lib/theme.ts#L1-L14)
- [app/components/ThemeToggle.tsx](file://app/components/ThemeToggle.tsx#L1-L54)
- [app/components/LanguageSwicher.tsx](file://app/components/LanguageSwicher.tsx#L1-L28)
- [next.config.ts](file://next.config.ts#L1-L17)

## 代码贡献流程

### 分支策略
建议采用以下分支命名规范：
- `main`：主分支，保护分支，仅通过 PR 合并
- `feature/xxx`：功能开发分支
- `bugfix/xxx`：缺陷修复分支
- `docs/xxx`：文档更新分支

### 提交规范
- 使用清晰、简洁的提交信息
- 遵循 [Conventional Commits](https://www.conventionalcommits.org/) 规范
- 提交信息使用英文描述

### Pull Request 指南
1. Fork 仓库并创建本地分支
2. 实现功能或修复问题
3. 确保代码通过 ESLint 检查
4. 提交 Pull Request，包含以下内容：
   - 变更描述
   - 相关截图（如 UI 变更）
   - 测试说明
5. 等待代码审查反馈
6. 根据反馈进行修改
7. 合并到主分支

**Section sources**
- [README.md](file://README.md#L300-L310)
- [package.json](file://package.json#L9-L11)